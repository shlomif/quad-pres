cache:
    - $HOME/perl5
os: linux
dist: trusty
before_install:
    - sudo apt-get update -qq
    - sudo apt-get install -y cmake cmake-data ninja-build python3-pip ack-grep cpanminus perl libperl-dev valgrind wml
    - sudo dpkg-divert --local --divert /usr/bin/ack --rename --add /usr/bin/ack-grep
install:
    - which python3
    - cpanm local::lib
    - eval "$(perl -Mlocal::lib=$HOME/perl_modules)"
    - cpanm Bundle::QuadPres Class::XSAccessor File::Copy::Recursive File::Find::Object::Rule HTML::Lint HTML::Widgets::NavMenu::EscapeHtml IO::All MooX MooX::late Path::Tiny Template Test::Trap
    - cpanm Dist::Zilla Pod::Weaver::Section::Support
    - perl CI-testing/continuous-integration-testing.pl install_deps
    - bash scripts/install-git-cmakey-program-system-wide.bash 'git' 'src' 'https://github.com/thewml/website-meta-language.git'
perl:
    - "5.26"
python:
    - "3.6"
script: perl CI-testing/continuous-integration-testing.pl test
